/*
@title: You are the imposter...
@author: Andy
*/

const player = "p";
const imposter = "i";
const verticalWall = "v";
const horizontalWall = "w";
const crossWall = "c";
const background = "b";


let level = 0;
let finish = 3;
const levels = [map`
...v.........
.i.v.........
...v..v......
...v..v......
...cwwc..wwww
.............
w.wcwc..v....
...v....vp...
...v....v....`, map`
iv........
.v..v.v...
.v..v.cwc.
.v..v.v.v.
.v.wc...v.
....v...v.
.v..v...v.
.cwwc...v.
....v.wwcw
.v..v....p`, map`
i.v........v.......
..v.v.cwwc.v...cwc.
..v.v.v..v.cww.v.v.
..v.v.v..v.....v.v.
..v.v.v.cccwwwwc.v.
..cwc.v.vp.........
......v.cwcwwwwwwcw
..cww.v............
..v...v.cwwwwwwwww.
wwc.wwcwcwwwwwwwwc.
......v............
..v................`, map`
..........
..........
..........
..........
..........
..........`];
const currentLevel = levels[level];

setLegend(
  [ imposter, bitmap`
................
................
.......33.......
.....333333.....
....33333333....
....333337777...
..33333337777...
..33333333777...
..3333333377....
..3333333333....
..3333333333....
....33333333....
....333..333....
.....33..33.....
................
................`], 
  [ player, bitmap`
................
................
.....00000......
...00000000.....
...0000000000...
..77700000000...
..777000000000..
..777000000000..
...0000000000...
...000000000....
...000000000....
...0000..000....
....00...00.....
................
................
................`],
  [ verticalWall, bitmap`
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......`], [ crossWall, bitmap`
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
0000000000000000
0000000000000000
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......
.......00.......`], [horizontalWall, bitmap`
................
................
................
................
................
................
................
0000000000000000
0000000000000000
................
................
................
................
................
................
................`]
);


setMap(currentLevel);
setSolids([imposter, verticalWall, horizontalWall, crossWall]);



onInput("s", () => {
  getFirst(imposter).y += 1
});

onInput("w", () => {
  getFirst(imposter).y-= 1
});

onInput("a", () => {
  getFirst(imposter).x-= 1
});

onInput("d", () => {
  getFirst(imposter).x+= 1
});


const checkPosition = () => {
  
  const { y: playerY, x: playerX } = getFirst(player);

  const { y:imposterY, x: imposterX } = getFirst(imposter);
  
  if ((imposterX === playerX) && (imposterY === playerY)) { 
    level++;
    setMap(levels[level]);
    
    }
  
  if (level === 3) {
      addText("Good Job!", {x:6, y:7, color:[0,255,0]})
    
  }
  
}


afterInput(() => {
  checkPosition()
})
